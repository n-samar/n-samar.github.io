<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.0.2 (456266)"/><meta name="author" content="NIKOLA SAMARDZIC"/><meta name="created" content="2018-03-09 05:31:05 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-03-09 05:31:56 +0000"/><title>Ch 4 -- Network Layer</title></head><body><div><br/></div><hr/><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Chapter 4: The Network Layer</span></div><hr/><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network layer provides host to host communication service</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">One of the most complex layers in the protocol stack</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Two approaches to implementing the network layer:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Datagram</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">virtual-circuit model</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Important distinction between the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">forwarding </span><span style="font-size: 12px; font-family: 'Helvetica Neue';">and </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">routing</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> functions of the network layer.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Forwarding involves the transfer of a packet from an incoming link to an outgoing link within a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic;">single</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> router.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routing involves </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic;">all</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> of a network’s routers, whose collective interactions via routing protocols determine the paths that packets take on their trips from source to destination node.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Three major parts of this chapter:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">network-layer functions and services (Section 4.1, 4.2)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">forwarding (Sections 4.3, 4.4)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">routing (Sections 4.5, 4.7)</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When sending a message from one host to another, the Transport level segment (packet with appropriate transport header) is encapsulated into the network-layer </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">datagram</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The role of the networking layer is to move packets from a sending host to a receiving host. Two important functions that facilitate this are:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Forwarding</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. When a packet arrives at a router’s input link, the router must move the packet to the appropriate output link.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Routing</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The network layer must determine the route or path taken by packets as they flow from a sender to a receiver. The algorithms that calculate this path are called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">routing algorithms</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each router has a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">forwarding table</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, which maps data in the datagram header to the appropriate outgoing link. Each router has its own forwarding table.</span></li></ul><div><br/></div><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-08%20at%204.03.48%20PM.png" height="468" width="516"/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The values stored in a router’s forwarding table are calculated by the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">routing algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The routing algorithm may be </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">centralized</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> (i.e. the algorithm executing on a central site and downloading routing information to each of the routers) </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">decentralized</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> (i.e. with a part of the distributed routing algorithm running in each router)</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Packet switch</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">: a general packet-switching device that transfers a packet from input link interface to output link interfaces according to the value in a field in the header of the packet.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Link-layer switches</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">: packet switches that base their forwarding decision on values in the fields of the link-layer frame; switches are thus referred to as link-layer devices.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Routers</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> base their forwarding decision on the value in the network-layer field. Routers are thus </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">network-layer devices</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, but must also implement link layer protocols, since network layer devices require the services of the link layer to implement their network layer functionality.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Connection setup</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">: Third important functionality used in some network layer implementations. Sometimes, the network routers along a path are all required to handshake with each other in order to set up state before network-layer data packets within given source-to-destination connection can begin to flow (similar to three-way handshake of two hosted necessitated by TCP)</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Network Service Models</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">network services model</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> defines the characteristics of end-to-end transport of packets between sending and receiving end systems.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Possible services the network layer can provide:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Guaranteed delivery</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Guarantee that the packet will eventually arrive at its destination.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Guaranteed delivery with bounded delay</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">In-order packet delivery</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Guaranteed minimal bandwidth</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. This is a throughput guarantee.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Guaranteed maximum jitter</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Guarantees that the amount of time between the transmission of two successive packets at the sender is equal to the amount of time between their receipt at the destination (or that it is within a certain boundary).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Security services</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Datagram encryption and security.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Internet’s network layer takes a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">best-effort service</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> approach. There are sound reasons for this minimalist approach to network layer implementations.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">However, the  </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">ATM network architecture</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> provides the option of choosing any number of network guarantees on a specific packet. Two of the more important ATM service models are:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Constant bit rate (CBR) ATM network service</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The variability in the end-to-end delay (i.e., the jitter), and the fraction of packets that are lost or delivered late are all guaranteed to be less than a specified value.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Available bit rate (ABR)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Guarantees there will be no reordering of packets, and a minimum packet transmission rate is guaranteed to any connection that uses ABR.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Virtual Circuit and Datagram Networks</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Similar to the transport layer, the network layer can provide connectionless service or connection service between two hosts. A connection network layer service involves handshakes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Crucial differences between connection/connectionless network layer and transport layer:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In the network layer, these services are host-to-host services provided by the network layer for the transport layer. In the transport layer these services are process-to-process services provided by the transport layer for the application layer.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">All network layers to date provide either a host-to-host connectionless service or a host-to-host connection service, but not both. Computer networks that provide only a connection service at the network layer are called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">virtual-circuit (VC) networks</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Computer networks that provide only a connectionless service at the network layer are called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">datagram networks</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The network layer connection service is implemented in the routers in the network core as well as in the end systems, while the transport layer connection service is provided only at the end systems.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Virtual-Circuit Networks</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The network layer connections implemented in a VC network are called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">virtual circuits (VCs)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A VC consists of:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">a path, i.e. a series of links and routers between the source and destination hosts</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">VC numbers, one number for each link along the path</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">entries in the forwarding table in each router along the path</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A packet belonging to a virtual circuit will carry a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">VC number</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> in its header.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The virtual circuit might have a different VC number on each link, each intervening router must replace the VC number of each traversing packet with a  new VC number. The new VC number is obtained from the forwarding table.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Whenever a new VC is established across a router, an entry is added to the forwarding table. Similarly, when a VC terminates, the appropriate entries in each table along its path are removed.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Why doesn’t a packet just keep the same VC number on each of the links along the route?</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Replacing the number from link to link reduces the length of the VC field in the packet header.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">More importantly, VC setup is considerably simplified by permitting a different VC number at each link along the path of  the VC. If a common VC number were required for all links along the path, the router would have to exchange and process a substantial number of messages to agree on a common VC number to be used for a connection.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In a VC network, the network’s routers must obviously maintain </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">connection state information</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> for all ongoing connections. This is a crucial issue in networking.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Three identifiable phases in a virtual circuit:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">VC setup</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. During the setup phase, the sending transport layer contacts the network layer, specifies the receiver’s address, and waits for the network to set up the VC. The network layer determines the path between sender and receiver. The network layer also determines the path between sender and receiver, and adds appropriate entries in the forwarding tables in each router along the path. The network layer may also reserve specific resources for the VC.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Data transfer</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">VC teardown</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The network layer will inform the other party that the first closed the connection, update forwarding tables.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The messages that the end systems send into the network to initiate or terminate a VC, and messages passed between the routers to set up the VC are known as </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">signaling messages</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, while the protocols used to exchange these messages are often called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">signaling protocols</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Datagram networks</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">datagram network</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> each time an end system wants to send a packet, it stamps the packet with the address of the destination end system and then pops the packet into the network.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each of the routers along the path uses the packet’s destination address to forward the packet. Specifically, each router has a forwarding table that maps destination addresses to link interfaces; when a packet arrives the router uses the packet’s destination address to look up the appropriate output link interface in the forwarding table.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The router matches the target IP with the forwarding table which contains list of prefixes matched to the link output interfaces.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Origins of VC and Datagram Networks</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Since the Internet was intended for very intelligent, high-level computers to communicate, the communication effort was leveraged onto the end systems and minimal burden is put onto the network. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Since phones are fairly primitive devices, they required VC networks that took care of everything.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">What’s Inside a Router?</span></div><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-08%20at%2010.48.12%20PM.png" height="356" width="668"/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Four key router components:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Input ports</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Performs physical layer function of terminating an incoming physical link at a router</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Performs link layer functions needed to interoperate with the link layer at the other side of the incoming link.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The lookup function is performed at the input port.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Switching fabric</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Connects the router’s input and output ports</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Output ports</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Receives packets from switching fabric and transmits these packets on the outgoing link by performing the necessary link layer and physical layer functions.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Routing processor</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Executes the routing protocols</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Maintains routing tables and attached link state information</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Computes the router’s forwarding table.</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Control packets</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> (i.e., packets carrying routing protocol information) are forwarded from an input port to the routing processor.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">These forwarding functions are referred to </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">router forwarding plane</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The functions are implemented in hardware for better performance, and are provided by </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Broadcom</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">The router control plane</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> functions are usually implemented in software and operate on performing management functions and executing routing protocols.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Shadow copy of forwarding table are stored in every input port for efficiency.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Switching</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Switching can be accomplished in a number of ways:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Switching via memory</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The switching was traditionally done through the routing processor and input and output ports were just standard I/O devices to a full-fledged CPU. Limited by processing speed of the CPU.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Switching via a bus</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. An input port transfers a packet directly to the output port over a shared bus, without intervention by the routing processor. This is typically done by labeling the packet with its designated output port and sending it through the bus to all output ports, but having only the destination output port pick up the packet. Limited by the speed of the bus.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Switching via the interconnection network</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Capable of forwarding multiple packets in parallel in contrast to the above two (but only one packet per outgoing port).</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Output Processing</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Performs</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">selecting and de-queueing packets for transmission, and performing the needed link layer and physical layer transmission functions.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Where does queueing occur?</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Packet loss</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> may occur when no memory is available to store arriving packets.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">How large should the output port buffers be?</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Rule of thumb: should be equal to the average round-trip time times the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">link capacity</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> (the amount of bandwidth)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">For root routers that take on many packets and it turns out that they need not follow the above buffer size rule and can have that number be divided by the square root of the number of packets.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Consequence of the buffering is that there must be a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">packet scheduler</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> on the outbound. Packet scheduling is key to providing </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">quality-of-service guarantees</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Also, if there is not enough memory to buffer an incoming packet, a decision must be made which packet to drop. If we always drop the incoming packet that is called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">drop-tail</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A number of packet-dropping and -marking policies are known and are labeled as </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">active queue management (AQM)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> algorithms.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Random Early Detection (RED)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> algorithm. One of the widely implemented AQMs.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A weighted average is maintained for the length of the output queue.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If the average queue length is less than a minimum threshold, when a packet arrives, the packet is admitted to the queue.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If the average queue length is greater than a maximum threshold, when a packet arrives, the packet is marked or dropped.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If the average queue length is between the maximum and minimum thresholds the packets are marked or dropped with a certain probability.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If switch fabric is not fast enough to transfer all arriving packets through the fabric without delay, then packet queuing can also occur at the input ports.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Head-of-the-line (HOL) blocking</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The idea that if input ports get congested, the head of the line might be competing to enter the output port with packets on other input ports. Even though other packets behind it may be able to go to output ports that are not competed for, they can’t due to the fact that the initial packet is in front of them in the input buffer.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">The Internet Protocol (IP): Forwarding and Addressing in the Internet</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Datagram Format</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Key fields are:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Version number</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The version of the IP protocol used.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Header length</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Variable since IPv4 datagram may contain options.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Type of service</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. For example, for labeling datagrams requiring low delay, high throughput, or reliability/</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Datagram length</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Identifier, flags, fragmentation offset</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Have to do with IP fragmentation.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Time-to-live</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, included to ensure datagrams do not circulate forever in the network.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Protocol</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Only used by end system. Specifies TCP/UDP.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Header checksum</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Aids the router with detecting bit errors in a received IP datagram. Sums each two bytes using 1s complement. Routers typically discard datagrams that have detected corruption.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Why does TCP/IP perform error checking at both the network and transport layer?</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Only the IP header is checksummed at the IP layer, while TCP/UDP checksum is computed over the entire TCP/UDP segment.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">TCP/UDP and IP need not belong to the same protocol stack. i.e. TCP can be paired with another network protocol, for example.</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Source and destination IP addresses</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Options</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Allows the header to be extended arbitrarily.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Data (payload)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Usually contains the transport-layer segment to be delivered.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This means TCP/IP have header overhead of 40 bytes total (20 bytes each).</span></li></ul><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-09%20at%2012.30.58%20AM.png" height="378" width="506"/><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">IP Datagram Fragmentation</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Not all link layer protocols can carry packets of arbitrary sizes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The maximum amount of data that a link layer frame can carry is called the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">maximum transmission unit (MTU)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each router may use a different link layer protocol and therefore might have different MTUs. So, the IP datagram must be fragmented if it enters a router that has an MTU smaller than the input datagram.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each of these smaller datagrams is called a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">fragment</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The job of datagram reassembly is performed by the end systems to keep the network core simpler. To aid refragmentation, the IP contains </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">identification</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">flag</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, and </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">fragment offset</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> fields in the IP datagram header.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When the destination receives a series of datagrams from the same sending host, it can examine the identification numbers of the datagrams to determine which of the datagrams are actually part of the same larger datagram.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Since IP is unreliable, some fragments may not arrive. To solve this, the last fragment in a datagram will have the flag bit set to zero</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The offset field is used to determine how to reassemble to fragments of one datagram and determine which fragment is missing.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">All but the last fragment, must have a payload that is a multiple of 8 bytes and the offset value is specified in units of 8-byte chunks.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IPv6 does not use fragments at all.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">IPv4 Addressing</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Written in </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">dotted-decimal notation</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, 4 bytes, with dot between every byte.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each interface on every host and router in the global Internet must have a globally unique IP address.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The boundary between a host and its link and the boundary between a router and any of its links is called an </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">interface</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li></ul><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-09%20at%2010.11.14%20AM.png" height="356" width="519"/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The picture above forms three </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">subnets</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> (223.1.1.0/24, 223.1.3.0/24, 223.1.2/24) with appropriate </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">subnet masks</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">To determine the subnets, detach each interface from its host or router, creating islands of isolated networks, with interfaces terminating the end points of the isolated networks. Each of these isolated networks is clad a subnet.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Classless Interdomain Routing (CIDR)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. INternet’s address assignment strategy.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">255.255.255.255 - the IP broadcast address, when you send to this address the message is delivered to all hosts on the same subnet.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Obtaining a Block of Addresses</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In order to obtain a block of IP addresses for use within an organization’s subnet, a network administrator might first contact its ISP, which would provide addresses from a larger block of addresses that had already been allocated to the USP.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IP addresses are globally managed by the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Internet Corporation for Assigned Names and Numbers (ICANN)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Obtaining the Host Address: the Dynamic Host Configuration Protocol</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Once an organization has obtained a block of addresses, it can assign individual IP addresses to the host and router interfaces in its organization.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A system administrator will typically manually configure the IP addresses into the router.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Host addresses could be configure manually, but this is now more often does by the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Dynamic Host Configuration Protocol (DHCP)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This protocol allows the host to get an IP address automatically.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">DHCP also provides the host with info on:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">the subnet mask of the host</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">the address of the first-hop router</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">the address of its local DNS server</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">As you go from classroom, to dorm, to library you connect to different wireless routers, thus connecting to different subnets, thus DHCP will generate a new IP address for your computer each time you connect to a new wireless router.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Since DHCP is a client-server protocol, it requires a server to run on.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If a subnet does not have it’s own DHCP server, a DHCP relay agent that knows the address of a DHCP server for that network is needed.</span></li></ul><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-09%20at%2010.36.15%20AM.png" height="417" width="556"/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Four steps performed by DHCP when a new host arrives:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP server discovery</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. A newly arriving host must first find a DHCP server with which to interact. Client sends a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP discover message</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, through UDP packet to port 67 with the broadcast destination IP address of 255.255.255.255 and a this host source IP address of 0.0.0.0.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP server offer</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. A DHCP server receiving a DHCP discover message responds to the client with a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP offer message</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> that is broadcast to all nodes on the subnet using the IP broadcast address of 255.255.255.255. Since there may be multiple DHCP servers on the subnet, the client has to choose an offer. Each offer contains:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The ID of the received discover message</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The proposed IP address for the client</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The network mask</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IP address </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">lease time</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> — the amount of time for which the proposed IP address will be valid (commonly several hours or days).</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP request</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Client chooses from among one or more server offers and responds to its selected offer with a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP request message</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, echoing back the configuration parameter.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP ACK</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The server responds to the DHCP request message with a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">DHCP ACK message</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, confirming the requested parameters</span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">DHCP also provides a mechanism that allows a client to renew its lease on an IP address.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Due to the fact that a host’s IP address is obtained through a subnet’s DHCP, a TCP connection to a remote application cannot be maintained as a mobile node moves between subnets.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Network Address Translation (NAT)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">NAT-enabled routers</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> has a single IP address and all traffic entering it must have this single IP destination. Once the packet reaches the NAT router, the router resolves sending this packet to the appropriate host within the local network.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The NAT router gets its IP address from the DHCP of the router.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If all datagrams arriving at the NAT router from the WAN have the same destination IP address (i.e., that of the NAT router), then how does the router know the internal host to which it should forward a given datagram?</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">NAT translation table</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> within the NAT router: The host sends a message through the NAT router into the Internet. The NAT router changes the port number to a port of its own that isn’t occupied, and changes the source IP to its own; it also records the appropriate port number and IP used by the host in the NAT translation table.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Possible problem: If a host is behind a NAT, you cannot initiate a connection to it (very big issue for P2P)</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">UPnP</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Universal Plug and Play (UPnP)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> is a protocol that allows a host to discover and configure a nearby NAT.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">With UPnP an application running in a host can request a NAT mapping between its (&lt;private IP&gt;, &lt;private port number&gt;) and the (&lt;public IP&gt;, &lt;public port number&gt;) for some requested public port number. If the NAT accepts the request and creates the mapping, then nodes from the outside can initiate TCP connections to the public IP/port pair. Further, the application is informed of its public IP/port pair.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">For example if the NAT’s IP is 138.76.29.7 and the local IP of a host is 10.0.0.1 and the port number of an active socket is 3345, through UPnP the application can ask NAT to pair (10.0.0.1, 3345) with (138.76.29.7, 5001) where the public port  number (5001 here) is chosen by the application.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Internet Control Message Protocol (ICMP)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Three main components of internet’s network layer:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IP protocol</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Internet routing protocol</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ICMP</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ICMP is used by hosts and routers to communicate network-layer information to each other.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Architecturally, ICMP lies directly above IP, i.e. ICMPs are carried within IP datagrams.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ICMP messages have a type and code field and contain the header and first 8 bytes of the IP datagram that caused the ICMP message to be generated.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ping for example sends an ICMP type 8 code 0 message to the specified host. The destination host, seeing the echo request, sends back a type 0 code 0 ICMP echo reply.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Source quench message</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">: intended to be used for a congested router to send an ICMP source quench message to a host to force that shot to reduce its transmission rate.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">To trace the route a packet travels between two end systems, send messages with TTLs of 1, 2, 3, … At some point, each of the packets (datagrams) expire and the IP protocol dictates that the router in which the datagram expires must send an ICMP warning message to the source. This message includes the name of the router and its IP address.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">IPv6</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">All IP addresses are now exhausted, need more IP addresses</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The IPv6 notable datagram format changes:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Expanded addressing capabilities</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. IP address is now 128 bits long. Uses </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">any cast addresses</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, which allow a datagram to be delivered to any one of a group of hosts.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Streamlined 40-byte header</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Flow labeling and priority</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Flows, sets of packets, can be labeled to achieve better speeds for say real-time implementations.</span></li></ul></ul><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-09%20at%2011.53.23%20AM.png" height="303" width="521"/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Other parts of IPv6 datagram:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Version</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Traffic class</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Flow label</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Payload length</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Next header</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Identifies the protocol to which the contents of this datagram will be delivered.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Hop limit</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Contents of this field are decremented by one by each router that forwards the datagram. If the hop limit count reaches zero, the datagram is discarded.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Source and destination addresses</span><span style="font-size: 12px; font-family: 'Helvetica Neue'; text-decoration: underline;">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Data</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Fields not present in IPv6:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Fragmentation/Reassembly</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Only source and destination can perform fragmentation operations. If packet too big for router, it sends “Packet Too Big” ICMP error message back to the sender. This simplification considerably speeds up IP forwarding within the network.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Header checksum</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Since both the transport and link layers check for data corruption, it was felt this would be redundant on the network layer.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Options</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. There is no designated option field, but the next header can point to data that is used as an options field.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ICMPv6 also subsumes the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Internet Group Management Protocol (IGMP)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, used to manage a host’s joining and leaving of multicast groups and was previously a separate protocol from IPv4.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Transitioning from IPv4 to IPv6</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">How will the public internet, which is based on IPv4, be transitioned to IPv6?</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Already deployed IPv4-capable systems are not capable of handling IPv6 datagrams (while IPv6 systems can be made backward compatible with IPv4).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Dual-stack approach</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. A straightforward approach to integrating IPv6 nodes into the IPv4 internet.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Here, nodes are implemented to support both IPv4 and IPv6. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">These nodes must have both IPv6 and IPv4 addresses.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">These nodes must also know which linked nodes are capable of implementing which IP version. This can be solved with DNS</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Tunneling</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. If a IPv6 datagram must pass through a IPv4-only router, the datagram is encapsulated inside an IPv4 datagram, and an IPv6 router is set as the destination for the encapsulated datagram.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The IPv6 node on the receiving side of the tunnel eventually receives the IPv4 datagram (it is the destination of the IPv4 datagram!), determines that there is an IPv6 datagram encapsulated within it, extracts it and sends it further.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">IP security (IPSec)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IPSec is backward compatible with both IPv4 and IPv6.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If two hosts want to securely communicate, IPSec needs to be available only in those two hosts. All other routers and shots can continue to run vanilla IPv4.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IPSec is connection oriented (hosts first establish an IPSec session between themselves)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">On sending side, the transport layer passes a segment to IPSec; IPSec then encrypts the segment, appends additional security fields to the segment, and encapsulates the resulting payload in an ordinary IP datagram.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">At the receiving side, IPSec decrypts the message and forwards to transport layer.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Services provided by IPSec session:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Cryptographic agreement</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Mechanisms that allow the two communicating hosts to agree on cryptographic algorithms and keys.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Encryption of IP datagram payloads</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Data integrity</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Origin authentication</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Routing Algorithms</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Used to determine the path that packets take from senders to receivers.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Typically a host is attached directly to one router, the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">default router</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">We refer to the default router of the destination host as the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">destination router</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> and of the source as the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">source router</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">global routing algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> computes the least-cost path between a source and destination using complete, global knowledge about the network. </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This requires the algorithm to somehow obtain all the global routing data.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can run centrally, or replicated at multiple sites.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Key distinction from a distributed approach is that the algorithm requires complete knowledge of the network.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">These are also called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">link-state (LS) algorithms</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> because the weight of each link in the network must be known.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">decentralized routing algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> the calculation of the least-cost path is carried out in an iterative, distributed manner. No node has complete information about the costs of all network links. </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each node only knows the costs of its own directly attached links.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Called a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">distance-vector (DV) algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, because each node maintains a vector of estimates of costs to all other nodes in the network.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Aside from the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">centralized vs. distributed</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> distinction between routing algorithm, there is also the division of routing algorithms into </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">static vs. dynamic</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">static routing algorithms</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, routes change very slowly over time, often only as a result of human intervention</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">dynamic routing algorithms</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> the routing paths change as the network traffic loads or topology change.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A dynamic algorithm can be run either periodically or in direct response to topology or link cost changes.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Another dichotomy: </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">load-sensitive vs. load-insensitive algorithms</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">load-sensitive algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> link costs vary dynamically to reflect the current level of congestion in the underlying link.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;"> </span><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routing algorithms used in the current internet are load-insensitive because link cost does not correlate well to congestion levels on the link.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">The Link-State (LS) Routing Algorithm</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">To make the topology and link costs known, have each node broadcast link-state packets to all other nodes in the network.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This is done through </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">link-state broadcasting algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Determine the shortest path using </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Dijkstra’s algorithm</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Properties of </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Dijkstra’s algorithm</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">after k iterations, the least-cost paths are known to k destination nodes</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">among the least-cost paths to all destination nodes, these k paths will have the k smallest costs.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">To prevent unbalanced oscillations in the network have either the routers run the LS algorithms at different times, or have the routers broadcast their link costs at different times.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">The Distance-Vector Routing Algorithm</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Iterative, asynchronous, and distributed.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">With the DV algorithm, each node maintains the following routing information:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">For each neighbor, the cost of the directly attached neighbor</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The node’s distance vector, which contains the estimated least cost of reaching all other nodes in the network.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The distance vectors of all of its neighbors.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In a distributed, asynchronous algorithm, each node sends a copy of its distance vector to each of its neighbors.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Every time a node receives a neighbors distance vector, it updates its own.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">As long as this exchange is asynchronous, all distance vectors will converge to optimal values.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each node updates its distance vector estimate when it either sees a cost change in one of its directly attached links or receives a distance vector update from some neighbor.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each node sends its distance vector estimate to all its neighbors whenever the vector is changed.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Note that the algorithm is self terminating.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Routing loop</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">: When one node believes the optimal path is through neighbor, but neighbor believes the fastest path is through the initial node. This issue is caused by increases in link cost, and requires the packet to travel back-and-forth between the two neighbors before their distance vector estimates are adequately updated. Depending on the cost of the link that connects the neighbors and the increase of other link costs, the process may take a long time to resolve itself.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Poisoned reverse</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">: technique used to avoid the routing loop scenario.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If a node routes to its neighbor through another neighbor, then set the publicize from the node to the neighbor as infinite (even though it is not).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If the node, due to a change of link costs, decides to start transmitting directly to the neighbor, it will stop lying to its neighbors and publicize the actual cost of the link.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Does not solve the routing loop problem in general</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Let’s compare LS and DV routing. Note that N is the set of nodes (routers) and E is the set of edges (links):</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Message complexity</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">LS requires O(|N|, |E|) messages to be sent. when a link cost changes, the new link cost must be sent to all nodes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When link costs change, the DV algorithm advertises this only to neighbors and only if the new link cost results in a changed least-cost path for one of the nodes attached to that link.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Speed of convergence</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">LS gives an O(|N|^2) algorithm for calculating optimal paths.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The DV algorithm can converge slowly and suffers from the count-to-infinity problem</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Robustness</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In LS, a router could broadcast an incorrect cost for only one of its attached links. Provides extra robustness because each node calculates all routes on its own.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In DV, a node can advertise incorrect least-cost paths to any or all destinations.</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">So, no clear winner. Both LS and DV used in the internet today</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Hierarchical Routing</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The view held so far that all routers are equal among themselves is reductionist for two reasons:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Scale</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. As the number of routers becomes large, the overhead involved in computing, storing, and communication routing information becomes prohibitive.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Administrative autonomy</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Ideally, an organization should be able to run and administer its network as it wishes, while still being able to connect its network to other outside networks.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Both issues solved by organizing routers into </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">autonomous systems (ASs)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routers within the same AS all run the same routing algorithm and have information about each other.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The routing algorithm running within an AS is called an </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">intra-autonomous system routing protocol</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Gateway routers</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> are routers within an AS tasked to communicate with the outside world.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If there is only one gateway router, it is easy for the routers in the AS to figure out where they need to send packets that go outside the AS.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If there is more than one gateway router within the AS, in order to communicate with the outside world, the AS needs:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">to learn which destinations are reachable via the ASs that it is connected to</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">to propagate this reachability information to all the routers within the AS.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">These two tasks (obtaining and propagating interAS reachability information) is performed by the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">inter-AS routing protocol</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If an AS is reachable from two different neighboring ASs, use the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">hot-potato routing</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> protocol:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This means the AS sends the packet through the gateway that will get the packet out of the AS as fast as possible.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Intra-AS Routing in the Internet: RIP</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Protocol that determine how routing is performed within an autonomous system (AS).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Two protocols used extensively:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Routing Information Protocol (RIP)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Open Shortest Path First (OSPF)</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">RIP</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Distance-vector protocol very close to the idealized DV protocol.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Uses hop count as a cost metric (each link has a cost of 1)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cost is not calculated between source and destination routers but from source router to destination subnet.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routing updates are exchanged between neighbors approximately every 30 seconds using a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">RIP response message</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The response message contains a list of up to 25 destination subnets within the same AS as weak as the sender’s distance to each of the subnets.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each router keeps track of </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">routing table</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> which has 3 columns:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">destination subnet</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">identity of next router along the shortest path to destination subnet</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">number of hops to get to the destination subnet along the shortest path</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If a router does not hear from its neighbor at least once very 180 seconds, that neighbor is considered to be no longer reachable; i.e., either the router has died or the connection link has gone down. In that case RIP modifies the local routing table to reflect this and propagates the new table to its neighbors.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">RIP is implemented in UNIX at the application layer running over UDP. A process called </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">routed</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> executes RIP and communicates with </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">routed</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> processes running in neighboring routers.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Intra-AS Routing in the Internet: OSPF</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Link-state protocol</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Uses flooding of link-state information and Dijkstra leas-cost path algorithm.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each router constructs a complete topological map the entire autonomous system.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routers then run Dijkstra locally</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Individual link costs are configured by the network admin.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Router broadcasts routing info to all other routers in the autonomous system, not just to its neighboring routers.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each router broadcasts whenever there is a change in a link’s state.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Also broadcasts link state periodically (at least every 30 minutes)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Also checks that links are operational via HELLO messages sent to neighbors and allows</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Also, each router can get its neighbors network-wide link state database.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Some of the advances embodied in OSPF include:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Security</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Exchange between OSPF routers can be authenticated. Two authentication methods:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Simple</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Same password on each router. Password sent over in plaintext.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">MD5 Authentication</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Based on shared secret keys configured in all routers. Sequence numbers also used to prevent against replay attacks.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Multiple same-cost paths</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. When multiple paths to a destination have the same cost, OSPF allows multiple paths to be used.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Integrated support for unicast and multicast routing</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Multicast OSPF provides simple extensions to OSPF to provide for multicast routing.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Support for hierarchy within a single routing domain</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Ability to structure an autonomous system hierarchically.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">An OSPF autonomous system can be configured into hierarchical </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">areas</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Each area runs its own OSPF link-state routing algorithm and each router within an area broadcasts data only to other routers in the area.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Within each area, one or more </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">area border routers</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> are responsible for routing packets outside the area.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Exactly one OSPF area in the AS is configured to be the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">backbone area</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. The primary role of the backbone area is to route traffic between the other areas in the AS. Always contains all area border routers in the AS and may contain non-border routers as well. Therefore, all intra-area communication within an AS goes through the backbone area.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Inter-AS Routing: The Boarder Gateway Protocol (BGP)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">How are paths determined for source-destination pairs that span multiple ASs.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">BGP provides each AS a means to:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Obtain subnet reachability information from neighboring ASs</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Propagate the reachability information to all routers internal to the AS</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Determine good routes to subnets based on the reachability information and on AS policy.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">So, BGP allows each subnet to advertise its existence to the rest of the Internet.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In BGP, pairs of routers exchange routing information over semipermanent TCP connections. Typically, there is one such BGP TCP connection for each link that directly connects two routers in two different ASs.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A BGP session that spans two ASs is called an external </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">BGP (eBGP) session</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A BGP session that is within one AS is called an internal </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">BGP (iBGP) session</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">BGP propagates subnet or subnet group prefixes across ASs. (remember the longest prefix match rule)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In BGP, an autonomous system is identified by its globally unique </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">autonomous system number (ASN)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When a router advertises a prefix across a BGP session, it includes with the prefix a number of </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">BGP attributes</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. A prefix along with its attributes is called a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">route</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Two important BGP attributes:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">AS-PATH</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. This attribute contains the ASs through which the advertisement for the prefix has passed. Used to prevent looping advertisements.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">NEXT-HOP</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Provides critical link between the inter-AS and intra-AS routing protocols. The NEXT-HOP will specify the IP address of the gateway router’s interface that leads to another AS that contains the target IP. Through iBGP the internal nodes of the AS will find out where they need to send packets if they want to send to the target IP by looking into the NEXT-HOP variable.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Note that in the image below, the AS-PATHS to get to AS2 from AS1 are the same (the path is direct), however the NEXT-HOP attribute will point to two interfaces on completely different routers (called the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">peering links</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> between AS1 and AS2). thanks to NEXT-HOP each node within AS1 can use its internal data to determine through the hot potato protocol the fastest route between the appropriate peering links.</span></li></ul><div><br/></div><div><img src="Ch%204%20--%20Network%20Layer.resources/Screen%20Shot%202018-02-09%20at%208.18.38%20PM.png" height="438" width="549"/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Import policy</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. This is specified per AS and defines whether the AS is going to accept an advertised path to some outer prefix. The policy may filter out all paths that lead through some undesirable ASs, for example.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If there are multiple known, acceptable paths to the same prefix, BGP eliminates routes by going through the following list:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routes are assigned a local preference value as one of their attributes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">From the remaining routs (all with the same local preference value), the route with the shortest AS-PATH is selected. This looks a lot like DV algorithm, with cost associated to number of AS hops. But further selection criteria complicates stuff.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">From the remaining routes, the route with the closest NEXT-HOP router is selected (where cost is determined by whichever intra-AS algorithm is employed in that specific AS).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IF more than one remains, use identifiers to select routes.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Stub network</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. A network that cannot be used to communicate packets that are neither destined to go to a router inside of them, or come from them. This can be enforced by making the network not advertise any indirect connections it may theoretically facilitate through BGP.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Broadcast and Multicast Routing</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">So far we with </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">unicast</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> (i.e., point-to-point) communication, in which a single source node sends a packet to a single destination node.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">broadcast routing</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, the network layer provides a service of delivering a packet sent from a source node to all other nodes in the network</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Multicast routing</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> enables a single source node to send a copy of a packet to a subset of the other network nodes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Multicast can be trivially implemented through an </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">N-way-unicast</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Drawbacks of </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">N-way-unicast</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">efficiency (having the source node send out N copies through a single link is much slower than having the first hop be a single copy and then having the network copy this network N times)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Not all of the N target addresses may be known to the sender. However, this is often not the case, and additional network overhead is required for the sender to get this information.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">It would be unwise to rely on the unicast routing infrastructure to achieve broadcast because the whole network routing process relies on broadcasting.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Controlled Flooding</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Every router sends the received broadcast to all of its neighbors.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">But, the router needs to choose when to flood and when not so that cycles in the graph don’t create infinite packet streams.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">sequence-number-controlled flooding</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> a source node puts its address as well as a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">broadcast sequence number</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> into a broadcast packet, then sends the packet to all of its neighbors along with a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">broadcast sequence number</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Each node maintains a list of the source address and sequence number of each broadcast packet it has already received, duplicated, and forwarded.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When a node receives a broadcast packet, it first checks whether the packet is in this list. If so, it is dropped, otherwise it is duplicated and forwarded to the node’s neighbors.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A different approach to controlled flooding is </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">reverse path forwarding (RPF)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When a router receives a broadcast packet with a given source address, it transmits the packet on all of its outgoing links (except the one on which it was received) only if the packet arrived on the link that is on its own shortest unicast path back to the source. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Otherwise, the router simply discards the incoming packet without forwarding.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Spanning-Tree Broadcast</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Construct spanning tree; whenever a node broadcasts make the broadcast follow the spanning tree.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">center-based approach</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> to building a spanning tree in a distributed manner:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Define a center node called the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">rendezvous point or core</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Nodes unicast tree-join messages addressed to the center node.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A tree-join message is forwarded using unicast routing toward the center until it either arrives at a node that already belongs to the spanning tree or arrives at the center.</span></li></ul></ul><div><br/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Gnutella uses a form of sequence-number-controlled flooding with a 16-bit identifier and a 16-bit payload descriptor.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">It implemented </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">limited-scope flooding</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> because it attaches TTL to packets that is decremented on every hop and thus does not flood the whole network.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Multicast</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A service that delivers packets to only a subset of network nodes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Possible use cases include:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">bulk data transfer (developers distribute new software versions to users)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">streaming continuous media</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">shared data applications</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">data feeds</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">web cache updating</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">interactive gaming</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In the internet architecture a multicast packet is addressed using </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">address indirection</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. That is, a single identifier is used for the group of receivers</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In the internet, the single identifier that represents a group of receivers is a class D multicast IP address.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The group of receivers associated with a class D address is referred to as a </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">multicast group</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Multicast groups are managed by the </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Internet Group Management Protocol (IGMP)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Operates between host and its directly attached router</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IGMP provides the means for a host to inform its attached router that an application running on the host wants to join a specific multicast group</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network-layer multicast  routing algorithms are in charge of coordinating multicast routers throughout the internet.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Like ICMP, IGMP messages are carried within an IP datagram, with an IP protocol number of 2.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The membership_query message is sent by a router to all hosts on an attached interface to determine the set of all multicast groups that have been joined by the hosts on that interface.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Hosts respond to a membership_query message with an IGMP membership_report message.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">leave_group messages are used by hosts to inform the router the left a group. This is also achieved through </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">soft state</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, since leave_group messages are not required, and a leave group event can be inferred from the membership_query of the router.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Soft state protocols result in simpler control than hard-state protocols, which not only require state to be explicitly added and removed, but also require mechanisms to recover from the situation where the entity responsible for removing state has terminated prematurely or failed.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-weight: bold;">Multicast Routing Algorithms</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The goal of multicast routing is to find a tree of links that connects all of the routers that have attached hosts belonging to the multicast group. </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Multicast packets can then be routed along this tree from the sender.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Two approaches (differ according to whether a single group-shared tree is used to distribute the traffic for all senders in the group, or whether a source-specific routing tree is constructed for each individual sender).</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Multicast routing using a group-shared tree</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. Based on building a tree that spans all edge routers with attached hosts belonging to the multicast group (done via center-based approach). Critical question: how to select the center point?</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Multicast routing using a source-based tree</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">. </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">RPF algorithm used in practice for multicast datagrams originating at each source point.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Has to use </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">pruning</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> in order not to overflow the network with multicast messages: </span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A multicast router that receives multicast packets and has no attached hosts joined to that group will send a prune message to its upstream router. If a router receives prune messages from each of its downstream routers, then it can forward a prune message upstream (knowing that noe of it’s children are relevant to the specific multicast group)</span></li></ul></ul></ul></ul><div><br/></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">The most widely used Internet multicast routing protocol is </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">Protocol-Independent Multicast (PIM) routing protocol</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, which explicitly recognizes two multicast distribution scenarios.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">dense mode</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> multicast group members are densely located; that is, many or most of the routers in the area need to be involved in routing multicast datagrams. PIM dense mode is a flood-and-prune reverse path forwarding technique similar ti DVMRP.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">sparse mode</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> the number of routers with attached group members is small with respect to the total number of routers; group members are widely dispersed. PIM sparse mode uses rendezvous points to set up the multicast distribution tree. In </span><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">source-specific multicast (SSM)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';">, only a single sender is allowed to send traffic into the multicast tree, considerably simplifying the tree construction and maintenance.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">There are multi protocol extensions to BGP to allow it to carry routing information for other protocols, including multicast information.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue'; font-style: italic; text-decoration: underline;">The Multicast Source Discovery Protocol (MSDP)</span><span style="font-size: 12px; font-family: 'Helvetica Neue';"> can be used to connect together rendezvous points in different PIM sparse mode domains.</span></li></ul><div><br/></div></body></html>